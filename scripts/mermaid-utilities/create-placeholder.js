#!/usr/bin/env node

/**
 * Create a minimal transparent PNG file to serve as a placeholder for Mermaid diagrams
 * 
 * Usage: node create-placeholder.js <output-path> [width] [height]
 * Example: node create-placeholder.js blog/post/img/thumbnail.png 1200 630
 */

const fs = require('fs');
const path = require('path');

// Parse command line arguments
const args = process.argv.slice(2);

if (args.length < 1) {
  console.error('Usage: node create-placeholder.js <output-path> [width] [height]');
  console.error('Example: node create-placeholder.js blog/post/img/thumbnail.png 1200 630');
  process.exit(1);
}

const outputPath = args[0];
const width = args[1] || 1200;
const height = args[2] || 630;

// Create output directory if it doesn't exist
const outputDir = path.dirname(outputPath);
if (!fs.existsSync(outputDir)) {
  try {
    fs.mkdirSync(outputDir, { recursive: true });
    console.log(`Created directory: ${outputDir}`);
  } catch (error) {
    console.error(`Error creating directory ${outputDir}:`, error);
    process.exit(1);
  }
}

// Create a minimal transparent PNG file
// This is a standard transparent PNG header with minimal data
// Note: This creates a very basic 1x1 transparent PNG
// For a production system, consider using a library like 'canvas' or 'sharp'
// to create a properly sized transparent PNG with the correct dimensions
const minimalPNG = Buffer.from([
  0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, 0x00, 0x00, 0x00, 0x0D,
  0x49, 0x48, 0x44, 0x52, 0x00, 0x00, 0x04, 0xB0, 0x00, 0x00, 0x02, 0x76,
  0x08, 0x06, 0x00, 0x00, 0x00, 0xD8, 0x3F, 0x48, 0x44, 0x00, 0x00, 0x00,
  0x01, 0x73, 0x52, 0x47, 0x42, 0x00, 0xAE, 0xCE, 0x1C, 0xE9, 0x00, 0x00,
  0x00, 0x04, 0x67, 0x41, 0x4D, 0x41, 0x00, 0x00, 0xB1, 0x8F, 0x0B, 0xFC,
  0x61, 0x05, 0x00, 0x00, 0x00, 0x09, 0x70, 0x48, 0x59, 0x73, 0x00, 0x00,
  0x0E, 0xC3, 0x00, 0x00, 0x0E, 0xC3, 0x01, 0xC7, 0x6F, 0xA8, 0x64, 0x00,
  0x00, 0x00, 0x0D, 0x49, 0x44, 0x41, 0x54, 0x78, 0x5E, 0xED, 0xC1, 0x01,
  0x01, 0x00, 0x00, 0x00, 0xC2, 0xA0, 0xF7, 0x4F, 0x6D, 0x0E, 0x1A, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x80, 0x77, 0x03, 0x40, 0x40,
  0x00, 0x01, 0xAF, 0x73, 0x0D, 0x0E, 0x00, 0x00, 0x00, 0x00, 0x49, 0x45,
  0x4E, 0x44, 0xAE, 0x42, 0x60, 0x82
]);

try {
  fs.writeFileSync(outputPath, minimalPNG);
  console.log(`Created placeholder PNG at ${outputPath}`);
  console.log(`Note: This is a minimal 1x1 transparent PNG. For a proper placeholder with specified dimensions (${width}x${height}), consider using a graphics library.`);
} catch (error) {
  console.error(`Error creating placeholder at ${outputPath}:`, error);
  process.exit(1);
}
